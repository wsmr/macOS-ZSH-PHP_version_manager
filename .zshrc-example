# Example .zshrc configuration showing PVM integration with other tools
# This demonstrates best practices for organizing your shell configuration

# ============================================================================
# ENVIRONMENT VARIABLES
# ============================================================================

# Homebrew (should be first)
export PATH="/opt/homebrew/bin:/opt/homebrew/sbin:$PATH"

# Android SDK (if you use Android development)
export ANDROID_HOME=$HOME/Library/Android/sdk
export PATH=$PATH:$ANDROID_HOME/emulator
export PATH=$PATH:$ANDROID_HOME/platform-tools

# ============================================================================
# VERSION MANAGERS (Load early in config)
# ============================================================================

# NVM (Node Version Manager)
export NVM_DIR="$HOME/.nvm"
[ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && \. "/opt/homebrew/opt/nvm/nvm.sh"
[ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && \. "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"

# rbenv (Ruby Version Manager)
if command -v rbenv &> /dev/null; then
  eval "$(rbenv init - zsh)"
fi

# pyenv (Python Version Manager)
if command -v pyenv &> /dev/null; then
  export PYENV_ROOT="$HOME/.pyenv"
  export PATH="$PYENV_ROOT/bin:$PATH"
  eval "$(pyenv init -)"
fi

# ============================================================================
# ALIASES & SHORTCUTS
# ============================================================================

# General aliases
alias ll="ls -lah"
alias ..="cd .."
alias ...="cd ../.."

# Git aliases
alias gs="git status"
alias gp="git pull"
alias gc="git commit"
alias gco="git checkout"

# PHP/Composer aliases
alias ci="composer install"
alias cu="composer update"
alias cr="composer require"
alias cda="composer dump-autoload"

# Laravel aliases (if you use Laravel)
alias art="php artisan"
alias tinker="php artisan tinker"
alias migrate="php artisan migrate"
alias seed="php artisan db:seed"

# Project-specific PHP versions (example)
alias mylegacyproject="cd ~/projects/legacy && pvm 7.4"
alias mylaravelproject="cd ~/projects/laravel-app && pvm 8.3"

# ============================================================================
# CUSTOM FUNCTIONS
# ============================================================================

# Quick project setup with specific PHP version
function phpproject() {
    if [ -z "$1" ] || [ -z "$2" ]; then
        echo "Usage: phpproject <project-name> <php-version>"
        return 1
    fi
    mkdir -p "$1"
    cd "$1"
    pvm "$2"
    composer init
}

# Check all version managers at once
function versions() {
    echo "=== Installed Versions ==="
    echo ""
    echo "PHP:"
    pvm current
    echo ""
    echo "Node:"
    node -v 2>/dev/null || echo "Node not installed"
    echo ""
    echo "Ruby:"
    ruby -v 2>/dev/null || echo "Ruby not installed"
    echo ""
    echo "Python:"
    python3 --version 2>/dev/null || echo "Python not installed"
}

# ============================================================================
# PVM (PHP Version Manager) - MUST BE LOADED LAST
# ============================================================================

# Source PVM function
# Option 1: If installed via curl/wget
if [ -f "$HOME/.pvm/pvm.sh" ]; then
    source "$HOME/.pvm/pvm.sh"
fi

# Option 2: Inline function (paste pvm function here)
function pvm() {
    # ... (paste the pvm function from pvm.sh here)
}

# ============================================================================
# AUTO-LOAD PHP VERSION (Optional)
# ============================================================================

# Automatically switch PHP version based on .php-version file in directory
autoload -U add-zsh-hook

load-php-version() {
    if [ -f ".php-version" ]; then
        local php_version=$(cat .php-version | tr -d '[:space:]')
        if [ -n "$php_version" ]; then
            pvm "$php_version" > /dev/null 2>&1
        fi
    fi
}

# Uncomment to enable auto-switching when changing directories
# add-zsh-hook chpwd load-php-version

# ============================================================================
# ADDITIONAL TOOLS
# ============================================================================

# Angular CLI autocompletion (if you use Angular)
# source <(ng completion script)

# Docker completion
if command -v docker &> /dev/null; then
    # Add docker completion here if needed
fi

# ============================================================================
# PROMPT CUSTOMIZATION (Optional)
# ============================================================================

# Show current PHP version in prompt (requires Oh My Zsh or custom prompt)
# RPROMPT='$(pvm current | sed "s/Current PHP version: /PHP: /")'

# ============================================================================
# FINAL PATH CLEANUP
# ============================================================================

# Remove duplicate PATH entries
typeset -U PATH

# Display loaded configuration (optional - remove in production)
echo "âœ“ Shell configuration loaded"
echo "  Run 'pvm list' to see available PHP versions"
echo "  Run 'versions' to see all version managers"
